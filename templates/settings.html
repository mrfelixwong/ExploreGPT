{% extends "base.html" %}

{% block content %}
<form method="POST">
    <div class="grid">
        <!-- Model Configuration -->
        <div class="card">
            <h3>Model Configuration</h3>
            
            <div class="form-group">
                <label for="openai_model">OpenAI Model:</label>
                <select name="openai_model" id="openai_model">
                    <option value="gpt-4" {% if settings.models.openai == 'gpt-4' %}selected{% endif %}>GPT-4</option>
                    <option value="gpt-3.5-turbo" {% if settings.models.openai == 'gpt-3.5-turbo' %}selected{% endif %}>GPT-3.5 Turbo</option>
                </select>
            </div>
            
            
            <div class="form-group">
                <label for="google_model">Google Model:</label>
                <select name="google_model" id="google_model">
                    <option value="gemini-pro" {% if settings.models.google == 'gemini-pro' %}selected{% endif %}>Gemini Pro</option>
                </select>
            </div>
        </div>
        
        <!-- Provider Settings -->
        <div class="card">
            <h3>Provider Settings</h3>
            
            {% for provider in ['openai', 'google'] %}
                <h4>{{ provider|title }}</h4>
                
                <div class="form-group">
                    <label>
                        <input type="checkbox" name="{{ provider }}_enabled" 
                               {% if settings.provider_settings[provider].enabled %}checked{% endif %}>
                        Enabled
                    </label>
                </div>
                
                <div class="form-group">
                    <label for="{{ provider }}_priority">Priority (1 = highest):</label>
                    <input type="number" name="{{ provider }}_priority" id="{{ provider }}_priority"
                           value="{{ settings.provider_settings[provider].priority }}" min="1" max="10">
                </div>
                
                <div class="form-group">
                    <label>
                        <input type="checkbox" name="{{ provider }}_fallback"
                               {% if settings.provider_settings[provider].fallback %}checked{% endif %}>
                        Use as fallback
                    </label>
                </div>
            {% endfor %}
        </div>
        
        <!-- Response Settings -->
        <div class="card">
            <h3>Response Settings</h3>
            
            <div class="form-group">
                <label for="max_tokens">Max Tokens:</label>
                <input type="number" name="max_tokens" id="max_tokens" 
                       value="{{ settings.response_settings.max_tokens }}" min="100" max="4000">
            </div>
            
            <div class="form-group">
                <label for="timeout">Timeout (seconds):</label>
                <input type="number" name="timeout" id="timeout" 
                       value="{{ settings.response_settings.timeout }}" min="10" max="120">
            </div>
            
            <div class="form-group">
                <label for="temperature">Temperature:</label>
                <input type="number" name="temperature" id="temperature" step="0.1"
                       value="{{ settings.response_settings.temperature }}" min="0" max="2">
            </div>
            
            <div class="form-group">
                <label>
                    <input type="checkbox" name="parallel_requests"
                           {% if settings.response_settings.parallel_requests %}checked{% endif %}>
                    Send requests in parallel
                </label>
            </div>
            
            <div class="form-group">
                <label>
                    <input type="checkbox" name="show_metadata"
                           {% if settings.response_settings.show_metadata %}checked{% endif %}>
                    Show response metadata
                </label>
            </div>
        </div>
        
        <!-- Memory Settings -->
        <div class="card">
            <h3>Context Settings</h3>
            <p style="color: #666; font-size: 0.9em;">
                ExploreGPT automatically uses your recent conversation history as context for better responses.
                No configuration needed.
            </p>
        </div>
        
        <!-- Cost Management -->
        <div class="card">
            <h3>Cost Management</h3>
            
            <div class="form-group">
                <label>
                    <input type="checkbox" name="track_costs"
                           {% if settings.cost_management.track_costs %}checked{% endif %}>
                    Enable basic cost tracking
                </label>
                <p style="color: #666; font-size: 0.8em; margin-top: 0.25rem;">
                    <strong>Note:</strong> Cost estimates are approximate and may be outdated
                </p>
            </div>
        </div>
        
        <!-- UI Settings -->
        <div class="card">
            <h3>UI Settings</h3>
            
            <div class="form-group">
                <label for="selected_provider">AI Provider:</label>
                <select name="selected_provider" id="selected_provider">
                    <option value="openai" {% if settings.ui_settings.selected_provider == 'openai' %}selected{% endif %}>OpenAI</option>
                    <option value="google" {% if settings.ui_settings.selected_provider == 'google' %}selected{% endif %}>Google Gemini</option>
                </select>
            </div>
            
            <div class="form-group">
                <label for="theme">Theme:</label>
                <select name="theme" id="theme">
                    <option value="light" {% if settings.ui_settings.theme == 'light' %}selected{% endif %}>Light</option>
                    <option value="dark" {% if settings.ui_settings.theme == 'dark' %}selected{% endif %}>Dark</option>
                </select>
            </div>
            
            
            <div class="form-group">
                <label>
                    <input type="checkbox" name="show_timestamps"
                           {% if settings.ui_settings.show_timestamps %}checked{% endif %}>
                    Show response times
                </label>
            </div>
        </div>
    </div>
    
    <button type="submit" class="btn">Save Settings</button>
</form>

<!-- Cost Summary -->
{% if settings.cost_management.track_costs %}
    <div class="card" style="margin-top: 2rem;">
        <h3>Cost Summary</h3>
        <p><strong>Today:</strong> ${{ "%.4f"|format(cost_summary.today.total) }}</p>
        {% if cost_summary.warning %}
            <p style="color: #dc2626; font-size: 0.9em;">‚ö†Ô∏è {{ cost_summary.warning }}</p>
        {% endif %}
    </div>
{% endif %}

<!-- Debug Information (Claude Code Integration) -->
<div class="card" style="margin-top: 2rem;">
    <h3>üêõ Debug Information</h3>
    <p style="font-size: 0.9em; color: #666;">
        Set <code>CLAUDE_DEBUG=1</code> environment variable for enhanced debugging.<br>
        Logs will be written to <code>/tmp/exploregpt_logs/exploregpt_debug.log</code>
    </p>
</div>

{% endblock %}